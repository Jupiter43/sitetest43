<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Grand Theft Auto V</title>
<style>
  body {
    margin:0;
    font-family: Arial,sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    flex-direction:column;
    color:white;
    overflow-x:hidden;
    position: relative;
  }

  /* Слои фоновых изображений */
  .bg-layer {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    z-index:0;
    background-size: cover;
    background-position: center;
    transition: opacity 1s ease-in-out;
  }

  .game-box {
    text-align: center;
    background: rgba(0,0,0,0); /* прозрачный фон */
    padding: 20px;
    border-radius: 15px;
    position: relative;
    z-index:1;
  }

  .game-box img {
    width: 328px;
    height: 383px;
    margin-bottom: 20px;
  }

  .game-box h1 {
    font-size:28px;
    margin-bottom:20px;
    text-shadow: 1px 1px 5px black;
  }

  .play-btn {
    background: #28a745;
    color: white;
    padding: 15px 40px;
    border: none;
    border-radius: 8px;
    font-size: 18px;
    cursor: pointer;
  }
  .play-btn.disabled {
    background: #007bff;
    cursor: not-allowed;
  }

  .video-container {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: black;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 1;
  }
  .video-container video {
    max-width: 100%;
    max-height: 100%;
  }

  .notification {
    position: fixed;
    left: 0;
    right: 0;
    padding: 10px;
    text-align: center;
    font-weight: bold;
  }
  .notification.error {
    top: 0;
    background: red;
    color: white;
  }
  .notification.region {
    bottom: 0;
    background: orange;
    color: white;
  }

  .banner {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    width: 280px;
    height: 600px;
    z-index: 3;
  }
  .banner.left { left:0; }
  .banner.right { right:0; }

  /* Модальное окно */
  #modal {
    position: fixed;
    top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 5;
    display: none;
  }
  #modal-content {
    background: #222;
    padding: 20px;
    border-radius: 10px;
    color: white;
    text-align: center;
    width: 300px;
  }
  #modal-content input {
    padding: 5px;
    font-size: 16px;
    width: 80%;
  }
  #modal-content button {
    margin: 5px;
    padding: 8px 16px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    border: none;
  }
  #modal-content button.ok-btn { background: #28a745; color:white; }
  #modal-content button.no-btn { background: #007bff; color:white; }

</style>
</head>
<body>

<!-- Слои фоновых изображений -->
<div class="bg-layer" id="bg-current"></div>
<div class="bg-layer" id="bg-next" style="opacity:0;"></div>

<div class="game-box" id="main-screen">
  <img src="icon.png" alt="GTA V">
  <h1>Grand Theft Auto V</h1>
  <button class="play-btn" id="play-btn" onclick="startGame()">ИГРАТЬ</button>
</div>

<div class="video-container" id="video-screen">
  <video id="game-video" src="0.mp4"></video>
</div>

<!-- Модальное окно -->
<div id="modal">
  <div id="modal-content">
    <p>Введите код бета-тестера:</p>
    <input type="text" id="code-input" placeholder="Код">
    <div>
      <button class="ok-btn" onclick="submitCode()">ОК</button>
      <button class="no-btn" onclick="noCode()">Нету</button>
    </div>
  </div>
</div>

<script>
  // --- Фоновые изображения ---
  const backgrounds = ['0.png','fon1.png','fon2.png','fon3.png','fon4.png'];
  let currentBgIndex = 0;

  const bgCurrent = document.getElementById('bg-current');
  const bgNext = document.getElementById('bg-next');

  bgCurrent.style.backgroundImage = `url('${backgrounds[0]}')`;

  function changeBackground() {
    const nextIndex = (currentBgIndex + 1) % backgrounds.length;
    bgNext.style.backgroundImage = `url('${backgrounds[nextIndex]}')`;
    bgNext.style.opacity = 1;

    setTimeout(() => {
      bgCurrent.style.backgroundImage = `url('${backgrounds[nextIndex]}')`;
      bgNext.style.opacity = 0;
      currentBgIndex = nextIndex;
    }, 1000); // совпадает с CSS transition
  }

  setInterval(changeBackground, 5000);

  // --- Модальное окно и кнопки ---
  function startGame() { document.getElementById('modal').style.display = 'flex'; }

  function submitCode() {
    let code = document.getElementById('code-input').value.trim();
    document.getElementById('modal').style.display = 'none';
    if (code !== "8995") { alert("Неверный код!"); return; }
    playVideo();
  }

  function noCode() {
    document.getElementById('modal').style.display = 'none';
    disablePlay();
  }

  function disablePlay() {
    const playBtn = document.getElementById("play-btn");
    playBtn.innerText = "НЕДОСТУПНО";
    playBtn.classList.add("disabled");
    playBtn.disabled = true;

    const bannerLeft = document.createElement("img");
    bannerLeft.src = "3.png";
    bannerLeft.className = "banner left";
    document.body.appendChild(bannerLeft);

    const bannerRight = document.createElement("img");
    bannerRight.src = "4.png";
    bannerRight.className = "banner right";
    document.body.appendChild(bannerRight);
  }

  // --- Видео и региональная проверка ---
  function playVideo() {
    document.getElementById("main-screen").style.display = "none";
    const videoScreen = document.getElementById("video-screen");
    videoScreen.style.display = "flex";
    const video = document.getElementById("game-video");
    video.play();

    fetch("https://ipinfo.io/json?token=e2ffd2eef0cf12")
      .then(res => res.json())
      .then(data => {
        if (data.country === "RU") {
          setTimeout(() => {
            video.pause();
            let notif = document.createElement("div");
            notif.className = "notification region";
            notif.innerText = "Недоступно в вашем регионе. (Код: 403)";
            document.body.appendChild(notif);
          }, 3000);
        }
      })
      .catch(err => console.error("Ошибка определения региона:", err));

    video.onended = () => {
      window.location.href = window.location.pathname + "?error=404";
    };
  }

  window.onload = () => {
    if (window.location.search.includes("error=404")) {
      let notif = document.createElement("div");
      notif.className = "notification error";
      notif.innerText = "Произошла неизвестная ошибка! (Код: 404)";
      document.body.appendChild(notif);
    }
  };
</script>

</body>
</html>
